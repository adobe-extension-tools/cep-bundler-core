{"version":3,"file":"cep-bundler-core.esm.js","sources":["../src/templates/manifest.js","../src/templates/html.js","../src/templates/.debug.js","../src/index.js"],"sourcesContent":["var sizeTemplate = (name, width, height) =>\r\n  width !== undefined && height !== undefined ? `\r\n            <${name}>\r\n              <Width>${width}</Width>\r\n              <Height>${height}</Height>\r\n            </${name}>` : '';\r\n\r\nexport default ({\r\n  isDev,\r\n  bundleName,\r\n  bundleId,\r\n  hosts,\r\n  bundleVersion,\r\n  cepVersion,\r\n  extensions\r\n}) => {\r\n  return `<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"no\"?>\r\n<ExtensionManifest xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" ExtensionBundleId=\"${bundleId}\" ExtensionBundleName=\"${bundleName}\" ExtensionBundleVersion=\"${bundleVersion}\" Version=\"${cepVersion}\">\r\n  <ExtensionList>\r\n    ${extensions.map(extension => `<Extension Id=\"${extension.id}\" Version=\"${bundleVersion}\" />`).join('\\n    ')}\r\n  </ExtensionList>\r\n  <ExecutionEnvironment>\r\n    <HostList>\r\n      ${hosts\r\n        .map(host => `<Host Name=\"${host.name}\" Version=\"${host.version}\" />`)\r\n        .join('\\n      ')}\r\n    </HostList>\r\n    <LocaleList>\r\n      <Locale Code=\"All\"/>\r\n    </LocaleList>\r\n    <RequiredRuntimeList>\r\n      <RequiredRuntime Name=\"CSXS\" Version=\"${cepVersion}\" />\r\n    </RequiredRuntimeList>\r\n  </ExecutionEnvironment>\r\n  <DispatchInfoList>\r\n    ${extensions.map(extension => {\r\n      var commandLineParams = extension.cefParams.map(\r\n        cefParam => `<Parameter>${cefParam}</Parameter>`\r\n      )\r\n      var icons = [\r\n        { icon: extension.iconNormal, type: 'Normal' },\r\n        { icon: extension.iconRollover, type: 'RollOver' },\r\n        { icon: extension.iconDarkNormal, type: 'DarkNormal' },\r\n        { icon: extension.iconDarkRollover, type: 'DarkRollOver' },\r\n      ]\r\n        .filter(({ icon }) => !!icon)\r\n        .map(({ icon, type }) => `<Icon Type=\"${type}\">${icon}</Icon>`)\r\n        .join('\\n            ')\r\n      var size = sizeTemplate('Size', extension.panelWidth, extension.panelHeight);\r\n      var minSize = sizeTemplate('MinSize', extension.panelMinWidth, extension.panelMinHeight);\r\n      var maxSize = sizeTemplate('MaxSize', extension.panelMaxWidth, extension.panelMaxHeight);\r\n      var startOn = (!extension.lifecycle.startOnEvents || extension.lifecycle.startOnEvents.length === 0) ? '' : `\r\n          <StartOn>\r\n            ${extension.lifecycle.startOnEvents.map(e => `<Event>${e}</Event>`).join('\\n            ')}\r\n          </StartOn>`;\r\n      return `<Extension Id=\"${extension.id}\">\r\n      <DispatchInfo>\r\n        <Resources>\r\n          <MainPath>${isDev ? `./dev.${extension.id}.html` : extension.htmlFilename}</MainPath>\r\n          <CEFCommandLine>\r\n            ${commandLineParams.join('\\n            ')}\r\n          </CEFCommandLine>\r\n        </Resources>\r\n        <Lifecycle>\r\n          <AutoVisible>${extension.lifecycle.autoVisible}</AutoVisible>${startOn}\r\n        </Lifecycle>\r\n        <UI>\r\n          <Type>${extension.type || 'Panel'}</Type>\r\n          ${extension.menu === false ? '' : `<Menu>${extension.name}</Menu>`}\r\n          <Geometry>${size}${minSize}${maxSize}\r\n          </Geometry>${icons ? `\r\n          <Icons>${icons}</Icons>` : ''}\r\n        </UI>\r\n      </DispatchInfo>\r\n    </Extension>`}).join('\\n    ')}\r\n  </DispatchInfoList>\r\n</ExtensionManifest>`\r\n}","export default ({ title = 'CEP Panel', href }) => {\r\n  return `<!DOCTYPE html>\r\n<html>\r\n  <head>\r\n    <title>${title}</title>\r\n  </head>\r\n  <body>\r\n    <script>\r\n      window.location.href = \"${href}\";\r\n    </script>\r\n  </body>\r\n</html>`\r\n}","export default ({ extensions }) => {\r\n  return `<?xml version=\"1.0\" encoding=\"UTF-8\"?>\r\n<ExtensionList>\r\n  ${extensions.map(extension => `<Extension Id=\"${extension.id}\">\r\n    <HostList>\r\n      ${Object.keys(extension.debugPorts)\r\n        .map(\r\n          (host) =>\r\n            `<Host Name=\"${host.trim()}\" Port=\"${extension.debugPorts[host]}\" />`\r\n        )\r\n        .join('\\n      ')}\r\n    </HostList>\r\n  </Extension>`).join('\\n  ')}\r\n</ExtensionList>`\r\n}\r\n","import os from 'os'\r\nimport path from 'path'\r\nimport { execSync } from 'child_process'\r\nimport fs from 'fs-extra'\r\nimport defaults from 'lodash.defaults'\r\nimport manifestTemplate from './templates/manifest'\r\nimport panelTemplate from './templates/html'\r\nimport debugTemplate from './templates/.debug'\r\n\r\nfunction templateDebug(formatter) {\r\n  return [4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16]\r\n    .map(formatter)\r\n    .join(os.EOL)\r\n}\r\n\r\nexport function enablePlayerDebugMode() {\r\n  // enable unsigned extensions\r\n  if (process.platform === 'darwin') {\r\n    execSync(\r\n      templateDebug(i => `defaults write com.adobe.CSXS.${i} PlayerDebugMode 1`)\r\n    )\r\n  } else if (process.platform === 'win32') {\r\n    execSync(\r\n      templateDebug(\r\n        i => `REG ADD HKCU\\\\Software\\\\Adobe\\\\CSXS.${i} /f /v PlayerDebugMode /t REG_SZ /d 1`\r\n      )\r\n    )\r\n  }\r\n}\r\n\r\nexport function disablePlayerDebugMode() {\r\n  // disable unsigned extensions\r\n  if (process.platform === 'darwin') {\r\n    execSync(\r\n      templateDebug(i => `defaults write com.adobe.CSXS.${i} PlayerDebugMode 0`)\r\n    )\r\n  } else if (process.platform === 'win32') {\r\n    execSync(\r\n      templateDebug(\r\n        i => `REG DELETE HKCU\\\\Software\\\\Adobe\\\\CSXS.${i} /f /v PlayerDebugMode`\r\n      )\r\n    )\r\n  }\r\n}\r\n\r\nfunction camelToSnake(str) {\r\n  return str.replace(/([A-Z])/g, (part) => `_${part.toLowerCase()}`)\r\n}\r\n\r\nfunction isTruthy(str) {\r\n  return typeof str === 'string' && (str === '1' || str.toLowerCase() === 'true')\r\n}\r\n\r\nfunction getEnvConfig() {\r\n  const debugPortEnvs = Object.keys(process.env)\r\n    .filter((key) => key.indexOf('CEP_DEBUG_PORT_') === 0)\r\n  return {\r\n    bundleName: process.env.CEP_NAME,\r\n    bundleId: process.env.CEP_ID,\r\n    bundleVersion: process.env.CEP_VERSION,\r\n    cepVersion: process.env.CEP_CEP_VERSION,\r\n    hosts: process.env.CEP_HOSTS,\r\n    iconNormal: process.env.CEP_ICON_NORMAL,\r\n    iconRollover: process.env.CEP_ICON_ROLLOVER,\r\n    iconDarkNormal: process.env.CEP_ICON_DARK_NORMAL,\r\n    iconDarkRollover: process.env.CEP_ICON_DARK_ROLLOVER,\r\n    panelWidth: process.env.CEP_PANEL_WIDTH,\r\n    panelHeight: process.env.CEP_PANEL_HEIGHT,\r\n    panelMinWidth: process.env.CEP_PANEL_MIN_WIDTH,\r\n    panelMinHeight: process.env.CEP_PANEL_MIN_HEIGHT,\r\n    panelMaxWidth: process.env.CEP_PANEL_MAX_WIDTH,\r\n    panelMaxHeight: process.env.CEP_PANEL_MAX_HEIGHT,\r\n    debugPorts: debugPortEnvs.length > 0\r\n      ? debugPortEnvs.reduce((obj, key) => {\r\n        obj[key.replace('CEP_DEBUG_PORT_', '')] = parseInt(process.env[key], 10)\r\n        return obj\r\n      }, {})\r\n      : undefined,\r\n    debugInProduction: isTruthy(process.env.CEP_DEBUG_IN_PRODUCTION) || undefined,\r\n    cefParams: !process.env.CEP_CEF_PARAMS ? undefined : process.env.CEP_CEF_PARAMS.split(',')\r\n  }\r\n}\r\n\r\nfunction getPkgConfig(pkg, env) {\r\n  const pkgConfig = pkg.hasOwnProperty('cep')\r\n    ? (\r\n      pkg.cep.hasOwnProperty(env)\r\n        ? pkg.cep[env]\r\n        : pkg.cep\r\n    )\r\n    : {}\r\n  return {\r\n    bundleName: pkgConfig.name,\r\n    bundleId: pkgConfig.id,\r\n    bundleVersion: pkgConfig.version,\r\n    cepVersion: pkgConfig.cepVersion,\r\n    hosts: pkgConfig.hosts,\r\n    iconNormal: pkgConfig.iconNormal,\r\n    iconRollover: pkgConfig.iconRollover,\r\n    iconDarkNormal: pkgConfig.iconDarkNormal,\r\n    iconDarkRollover: pkgConfig.iconDarkRollover,\r\n    panelWidth: pkgConfig.panelWidth,\r\n    panelHeight: pkgConfig.panelHeight,\r\n    panelMinWidth: pkgConfig.panelMinWidth,\r\n    panelMinHeight: pkgConfig.panelMinHeight,\r\n    panelMaxWidth: pkgConfig.panelMaxWidth,\r\n    panelMaxHeight: pkgConfig.panelMaxHeight,\r\n    debugPorts: pkgConfig.debugPorts,\r\n    debugInProduction: pkgConfig.debugInProduction,\r\n    lifecycle: pkgConfig.lifecycle,\r\n    cefParams: pkgConfig.cefParams,\r\n    htmlFilename: pkgConfig.htmlFilename,\r\n    extensions: pkgConfig.extensions\r\n  }\r\n}\r\n\r\nfunction getConfigDefaults() {\r\n  return {\r\n    ...getExtensionDefaults(),\r\n    bundleName: 'CEP Extension',\r\n    bundleId: 'com.mycompany.myextension',\r\n    hosts: '*',\r\n    debugInProduction: false,\r\n    cepVersion: '7.0'\r\n  }\r\n}\r\n\r\nexport function getConfig(pkg, env) {\r\n  const config = defaults(\r\n    getEnvConfig(),\r\n    getPkgConfig(pkg, env),\r\n    getConfigDefaults(),\r\n    {\r\n      bundleVersion: pkg.version\r\n    }\r\n  )\r\n  config.hosts = parseHosts(config.hosts)\r\n  let extensions = []\r\n  if (Array.isArray(config.extensions)) {\r\n    extensions = config.extensions.map((extension, ii) => {\r\n      const extDefaults = getExtensionDefaults();\r\n      Object.keys(extDefaults.debugPorts).forEach(function (host) {\r\n        var port = extDefaults.debugPorts[host];\r\n        extDefaults.debugPorts[host] = port + ii * 1000;\r\n      });\r\n      return {\r\n        ...extDefaults,\r\n        ...extension\r\n      }\r\n    })\r\n  } else {\r\n    extensions.push({\r\n      id: config.bundleId,\r\n      name: config.bundleName,\r\n      ...config\r\n    })\r\n  }\r\n  config.extensions = extensions\r\n  return config\r\n}\r\n\r\nexport function objectToProcessEnv(obj) {\r\n  // assign object to process.env so they can be used in the code\r\n  Object.keys(obj).forEach(key => {\r\n    const envKey = camelToSnake(key).toUpperCase()\r\n    const value = typeof obj[key] === 'string'\r\n      ? obj[key]\r\n      : JSON.stringify(obj[key])\r\n    process.env[envKey] = value\r\n  })\r\n}\r\n\r\nexport function writeExtensionTemplates(opts) {\r\n  const manifestContents = manifestTemplate(opts)\r\n  const {\r\n    out,\r\n    debugInProduction,\r\n    isDev,\r\n    extensions\r\n  } = opts\r\n  const manifestDir = path.join(out, 'CSXS')\r\n  const manifestFile = path.join(manifestDir, 'manifest.xml')\r\n  return Promise.resolve()\r\n    .then(() => fs.ensureDir(manifestDir))\r\n    .then(() => fs.writeFile(manifestFile, manifestContents))\r\n    .then(() => {\r\n      let chain = Promise.resolve()\r\n      if (debugInProduction || isDev) {\r\n        const debugContents = debugTemplate(opts)\r\n        chain = chain.then(() => fs.writeFile(path.join(out, '.debug'), debugContents))\r\n      }\r\n      if (isDev) {\r\n        extensions.forEach(extension => {\r\n          const href = `http://${extension.devHost}:${extension.devPort}`\r\n          const panelContents = panelTemplate({\r\n            title: extension.name,\r\n            href\r\n          })\r\n          chain = chain.then(() => fs.writeFile(path.join(out, `dev.${extension.id}.html`), panelContents))\r\n        })\r\n      }\r\n      return chain\r\n    })\r\n}\r\n\r\nexport function parseHosts(hostsString) {\r\n  if (hostsString == '*')\r\n    hostsString = `PHXS, IDSN, AICY, ILST, PPRO, PRLD, AEFT, FLPR, AUDT, DRWV, MUST, KBRG`\r\n  const hosts = hostsString\r\n    .split(/(?![^)(]*\\([^)(]*?\\)\\)),(?![^\\[]*\\])/)\r\n    .map(host => host.trim())\r\n    .map(host => {\r\n      let [name, version] = host.split('@')\r\n      if (version == '*' || !version) {\r\n        version = '[0.0,99.9]'\r\n      } else if (version) {\r\n        version = version\r\n      }\r\n      return {\r\n        name,\r\n        version,\r\n      }\r\n    })\r\n  return hosts\r\n}\r\n\r\nexport function getExtenstionPath() {\r\n  if (process.platform == 'darwin') {\r\n    return path.join(\r\n      os.homedir(),\r\n      '/Library/Application Support/Adobe/CEP/extensions'\r\n    )\r\n  } else if (process.platform == 'win32') {\r\n    return path.join(process.env.APPDATA, 'Adobe/CEP/extensions')\r\n  }\r\n}\r\n\r\nfunction getSymlinkExtensionPath({ bundleId }) {\r\n  const extensionPath = getExtenstionPath()\r\n  return path.join(extensionPath, bundleId)\r\n}\r\n\r\nexport function symlinkExtension({ bundleId, out }) {\r\n  const target = getSymlinkExtensionPath({ bundleId })\r\n  return Promise.resolve()\r\n    .then(() => fs.ensureDir(getExtenstionPath()))\r\n    .then(() => fs.remove(target))\r\n    .then(() => {\r\n      if (process.platform === 'win32') {\r\n        return fs.symlink(path.join(out, '/'), target, 'junction')\r\n      } else {\r\n        return fs.symlink(path.join(out, '/'), target)\r\n      }\r\n    })\r\n}\r\n\r\nexport function copyDependencies({ root, out, pkg }) {\r\n  const deps = pkg.dependencies || {}\r\n  return Object.keys(deps).reduce((chain, dep) => {\r\n    if (dep.indexOf('/') !== -1) {\r\n      dep = dep.split('/')[0]\r\n    }\r\n    const src = path.join(root, 'node_modules', dep)\r\n    const dest = path.join(out, 'node_modules', dep)\r\n    let exists = false\r\n    try {\r\n      exists = fs.statSync(dest).isFile();\r\n    } catch (err) {}\r\n    if (!exists) {\r\n      chain = chain\r\n        .then(() => fs.copy(src, dest))\r\n        .catch(() => {\r\n          console.error(\r\n            `Could not copy ${src} to ${dest}. Ensure the path is correct.`\r\n          )\r\n        })\r\n        .then(() => {\r\n          try {\r\n            const packageJson = fs.readJsonSync(path.join(root, 'node_modules', dep, 'package.json'))\r\n            return copyDependencies({\r\n              root,\r\n              out,\r\n              pkg: packageJson\r\n            })\r\n          } catch (err) {\r\n            return\r\n          }\r\n        })\r\n      return chain\r\n    }\r\n    return chain\r\n  }, Promise.resolve())\r\n}\r\n\r\nexport function copyIcons({\r\n  root,\r\n  out,\r\n  iconNormal,\r\n  iconRollover,\r\n  iconDarkNormal,\r\n  iconDarkRollover\r\n}) {\r\n  const iconPaths = [\r\n    iconNormal,\r\n    iconRollover,\r\n    iconDarkNormal,\r\n    iconDarkRollover,\r\n  ]\r\n    .filter(icon => icon !== undefined)\r\n    .map(icon => ({\r\n        source: path.resolve(root, icon),\r\n        output: path.join(out, path.relative(root, icon)),\r\n    }))\r\n  return Promise.all(\r\n    iconPaths.map(icon => {\r\n      return fs.copy(icon.source, icon.output)\r\n        .catch(() => {\r\n          console.error(\r\n            `Could not copy ${icon.source}. Ensure the path is correct.`\r\n          )\r\n        })\r\n    })\r\n  )\r\n}\r\n\r\nfunction getExtensionDefaults() {\r\n  return {\r\n    panelWidth: 500,\r\n    panelHeight: 500,\r\n    htmlFilename: './index.html',\r\n    devPort: 8080,\r\n    devHost: 'localhost',\r\n    lifecycle: {\r\n      autoVisible: true,\r\n      startOnEvents: []\r\n    },\r\n    cefParams: [\r\n      '--allow-file-access-from-files',\r\n      '--allow-file-access',\r\n      '--enable-nodejs',\r\n      '--mixed-context'\r\n    ],\r\n    debugPorts: {\r\n      PHXS: 3001,\r\n      IDSN: 3002,\r\n      AICY: 3003,\r\n      ILST: 3004,\r\n      PPRO: 3005,\r\n      PRLD: 3006,\r\n      AEFT: 3007,\r\n      FLPR: 3008,\r\n      AUDT: 3009,\r\n      DRWV: 3010,\r\n      MUST: 3011,\r\n      KBRG: 3012,\r\n    }\r\n  }\r\n}\r\n\r\nexport function compile(opts) {\r\n  opts.env = opts.env ? opts.env : process.env.NODE_ENV\r\n  opts.root = opts.root ? opts.root : process.cwd()\r\n  opts.htmlFilename = opts.htmlFilename ? opts.htmlFilename : './index.html'\r\n  opts.pkg = opts.pkg ? opts.pkg : require(path.join(opts.root, '/package.json'))\r\n  opts.devHost = opts.devHost ? opts.devHost : 'localhost'\r\n  opts.devPort = opts.devPort ? opts.devPort : 8080\r\n  opts.isDev = opts.hasOwnProperty('isDev') ? opts.isDev : false\r\n  const config = getConfig(opts.pkg, opts.env)\r\n  const allOpts = {\r\n    ...opts,\r\n    ...config,\r\n  }\r\n  let chain = Promise.resolve()\r\n  if (opts.isDev) {\r\n    enablePlayerDebugMode()\r\n    if (!config.noSymlink) {\r\n      chain = chain.then(() => symlinkExtension(allOpts))\r\n    }\r\n  }\r\n  chain = chain.then(() => copyDependencies(allOpts))\r\n    .then(() => writeExtensionTemplates(allOpts))\r\n    .then(() => copyIcons(allOpts))\r\n  return chain\r\n}\r\n"],"names":["sizeTemplate","name","width","height","undefined","isDev","bundleName","bundleId","hosts","bundleVersion","cepVersion","extensions","map","extension","id","join","host","version","commandLineParams","cefParams","cefParam","icons","icon","iconNormal","type","iconRollover","iconDarkNormal","iconDarkRollover","filter","size","panelWidth","panelHeight","minSize","panelMinWidth","panelMinHeight","maxSize","panelMaxWidth","panelMaxHeight","startOn","lifecycle","startOnEvents","length","e","htmlFilename","autoVisible","menu","title","href","Object","keys","debugPorts","trim","templateDebug","formatter","os","EOL","enablePlayerDebugMode","process","platform","execSync","i","disablePlayerDebugMode","camelToSnake","str","replace","part","toLowerCase","isTruthy","getEnvConfig","debugPortEnvs","env","key","indexOf","CEP_NAME","CEP_ID","CEP_VERSION","CEP_CEP_VERSION","CEP_HOSTS","CEP_ICON_NORMAL","CEP_ICON_ROLLOVER","CEP_ICON_DARK_NORMAL","CEP_ICON_DARK_ROLLOVER","CEP_PANEL_WIDTH","CEP_PANEL_HEIGHT","CEP_PANEL_MIN_WIDTH","CEP_PANEL_MIN_HEIGHT","CEP_PANEL_MAX_WIDTH","CEP_PANEL_MAX_HEIGHT","reduce","obj","parseInt","debugInProduction","CEP_DEBUG_IN_PRODUCTION","CEP_CEF_PARAMS","split","getPkgConfig","pkg","pkgConfig","hasOwnProperty","cep","getConfigDefaults","getExtensionDefaults","getConfig","config","defaults","parseHosts","Array","isArray","ii","extDefaults","forEach","port","push","objectToProcessEnv","envKey","toUpperCase","value","JSON","stringify","writeExtensionTemplates","opts","manifestContents","manifestTemplate","out","manifestDir","path","manifestFile","Promise","resolve","then","fs","ensureDir","writeFile","chain","debugContents","debugTemplate","devHost","devPort","panelContents","panelTemplate","hostsString","getExtenstionPath","homedir","APPDATA","getSymlinkExtensionPath","extensionPath","symlinkExtension","target","remove","symlink","copyDependencies","root","deps","dependencies","dep","src","dest","exists","statSync","isFile","err","copy","console","error","packageJson","readJsonSync","copyIcons","iconPaths","source","output","relative","all","PHXS","IDSN","AICY","ILST","PPRO","PRLD","AEFT","FLPR","AUDT","DRWV","MUST","KBRG","compile","NODE_ENV","cwd","require","allOpts","noSymlink"],"mappings":"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"}