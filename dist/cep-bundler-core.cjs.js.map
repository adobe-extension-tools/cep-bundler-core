{"version":3,"file":"cep-bundler-core.cjs.js","sources":["../src/templates/manifest.js","../src/templates/html.js","../src/templates/.debug.js","../src/index.js"],"sourcesContent":["var sizeTemplate = (name, width, height) =>\n  width !== undefined && height !== undefined ? `\n            <${name}>\n              <Width>${width}</Width>\n              <Height>${height}</Height>\n            </${name}>` : '';\n\nexport default ({\n  isDev,\n  bundleName,\n  bundleId,\n  hosts,\n  bundleVersion,\n  cepVersion,\n  extensions\n}) => {\n  return `<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"no\"?>\n<ExtensionManifest xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" ExtensionBundleId=\"${bundleId}\" ExtensionBundleName=\"${bundleName}\" ExtensionBundleVersion=\"${bundleVersion}\" Version=\"${cepVersion}\">\n  <ExtensionList>\n    ${extensions.map(extension => `<Extension Id=\"${extension.id}\" Version=\"${bundleVersion}\" />`).join('\\n    ')}\n  </ExtensionList>\n  <ExecutionEnvironment>\n    <HostList>\n      ${hosts\n        .map(host => `<Host Name=\"${host.name}\" Version=\"${host.version}\" />`)\n        .join('\\n      ')}\n    </HostList>\n    <LocaleList>\n      <Locale Code=\"All\"/>\n    </LocaleList>\n    <RequiredRuntimeList>\n      <RequiredRuntime Name=\"CSXS\" Version=\"${cepVersion}\" />\n    </RequiredRuntimeList>\n  </ExecutionEnvironment>\n  <DispatchInfoList>\n    ${extensions.map(extension => {\n      var commandLineParams = extension.cefParams.map(\n        cefParam => `<Parameter>${cefParam}</Parameter>`\n      )\n      var icons = [\n        { icon: extension.iconNormal, type: 'Normal' },\n        { icon: extension.iconRollover, type: 'RollOver' },\n        { icon: extension.iconDarkNormal, type: 'DarkNormal' },\n        { icon: extension.iconDarkRollover, type: 'DarkRollOver' },\n      ]\n        .filter(({ icon }) => !!icon)\n        .map(({ icon, type }) => `<Icon Type=\"${type}\">${icon}</Icon>`)\n        .join('\\n            ')\n      var size = sizeTemplate('Size', extension.panelWidth, extension.panelHeight);\n      var minSize = sizeTemplate('MinSize', extension.panelMinWidth, extension.panelMinHeight);\n      var maxSize = sizeTemplate('MaxSize', extension.panelMaxWidth, extension.panelMaxHeight);\n      var startOn = (!extension.lifecycle.startOnEvents || extension.lifecycle.startOnEvents.length === 0) ? '' : `\n          <StartOn>\n            ${extension.lifecycle.startOnEvents.map(e => `<Event>${e}</Event>`).join('\\n            ')}\n          </StartOn>`;\n      return `<Extension Id=\"${extension.id}\">\n      <DispatchInfo>\n        <Resources>\n          <MainPath>${isDev ? `./dev.${extension.id}.html` : extension.htmlFilename}</MainPath>\n          <CEFCommandLine>\n            ${commandLineParams.join('\\n            ')}\n          </CEFCommandLine>\n        </Resources>\n        <Lifecycle>\n          <AutoVisible>${extension.lifecycle.autoVisible}</AutoVisible>${startOn}\n        </Lifecycle>\n        <UI>\n          <Type>${extension.type || 'Panel'}</Type>\n          ${extension.menu === false ? '' : `<Menu>${extension.name}</Menu>`}\n          <Geometry>${size}${minSize}${maxSize}\n          </Geometry>${icons ? `\n          <Icons>${icons}</Icons>` : ''}\n        </UI>\n      </DispatchInfo>\n    </Extension>`}).join('\\n    ')}\n  </DispatchInfoList>\n</ExtensionManifest>`\n}","export default ({ title = 'CEP Panel', href }) => {\n  return `<!DOCTYPE html>\n<html>\n  <head>\n    <title>${title}</title>\n  </head>\n  <body>\n    <script>\n      window.location.href = \"${href}\";\n    </script>\n  </body>\n</html>`\n}","export default ({ extensions }) => {\n  return `<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<ExtensionList>\n  ${extensions.map(extension => `<Extension Id=\"${extension.id}\">\n    <HostList>\n      ${Object.keys(extension.debugPorts)\n        .map(\n          (host) =>\n            `<Host Name=\"${host.trim()}\" Port=\"${extension.debugPorts[host]}\" />`\n        )\n        .join('\\n      ')}\n    </HostList>\n  </Extension>`).join('\\n  ')}\n</ExtensionList>`\n}\n","import os from 'os'\nimport path from 'path'\nimport { execSync } from 'child_process'\nimport fs from 'fs-extra'\nimport defaults from 'lodash.defaults'\nimport manifestTemplate from './templates/manifest'\nimport panelTemplate from './templates/html'\nimport debugTemplate from './templates/.debug'\n\nfunction templateDebug(formatter) {\n  return [4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16]\n    .map(formatter)\n    .join(os.EOL)\n}\n\nexport function enablePlayerDebugMode() {\n  // enable unsigned extensions\n  if (process.platform === 'darwin') {\n    execSync(\n      templateDebug(i => `defaults write com.adobe.CSXS.${i} PlayerDebugMode 1`)\n    )\n  } else if (process.platform === 'win32') {\n    execSync(\n      templateDebug(\n        i => `REG ADD HKCU\\\\Software\\\\Adobe\\\\CSXS.${i} /f /v PlayerDebugMode /t REG_SZ /d 1`\n      )\n    )\n  }\n}\n\nexport function disablePlayerDebugMode() {\n  // disable unsigned extensions\n  if (process.platform === 'darwin') {\n    execSync(\n      templateDebug(i => `defaults write com.adobe.CSXS.${i} PlayerDebugMode 0`)\n    )\n  } else if (process.platform === 'win32') {\n    execSync(\n      templateDebug(\n        i => `REG DELETE HKCU\\\\Software\\\\Adobe\\\\CSXS.${i} /f /v PlayerDebugMode`\n      )\n    )\n  }\n}\n\nfunction camelToSnake(str) {\n  return str.replace(/([A-Z])/g, (part) => `_${part.toLowerCase()}`)\n}\n\nfunction isTruthy(str) {\n  return typeof str === 'string' && (str === '1' || str.toLowerCase() === 'true')\n}\n\nfunction getEnvConfig() {\n  const debugPortEnvs = Object.keys(process.env)\n    .filter((key) => key.indexOf('CEP_DEBUG_PORT_') === 0)\n  return {\n    bundleName: process.env.CEP_NAME,\n    bundleId: process.env.CEP_ID,\n    bundleVersion: process.env.CEP_VERSION,\n    cepVersion: process.env.CEP_CEP_VERSION,\n    hosts: process.env.CEP_HOSTS,\n    iconNormal: process.env.CEP_ICON_NORMAL,\n    iconRollover: process.env.CEP_ICON_ROLLOVER,\n    iconDarkNormal: process.env.CEP_ICON_DARK_NORMAL,\n    iconDarkRollover: process.env.CEP_ICON_DARK_ROLLOVER,\n    panelWidth: process.env.CEP_PANEL_WIDTH,\n    panelHeight: process.env.CEP_PANEL_HEIGHT,\n    panelMinWidth: process.env.CEP_PANEL_MIN_WIDTH,\n    panelMinHeight: process.env.CEP_PANEL_MIN_HEIGHT,\n    panelMaxWidth: process.env.CEP_PANEL_MAX_WIDTH,\n    panelMaxHeight: process.env.CEP_PANEL_MAX_HEIGHT,\n    debugPorts: debugPortEnvs.length > 0\n      ? debugPortEnvs.reduce((obj, key) => {\n        obj[key.replace('CEP_DEBUG_PORT_', '')] = parseInt(process.env[key], 10)\n        return obj\n      }, {})\n      : undefined,\n    debugInProduction: isTruthy(process.env.CEP_DEBUG_IN_PRODUCTION) || undefined,\n    cefParams: !process.env.CEP_CEF_PARAMS ? undefined : process.env.CEP_CEF_PARAMS.split(',')\n  }\n}\n\nfunction getPkgConfig(pkg, env) {\n  const pkgConfig = pkg.hasOwnProperty('cep')\n    ? (\n      pkg.cep.hasOwnProperty(env)\n        ? pkg.cep[env]\n        : pkg.cep\n    )\n    : {}\n  return {\n    bundleName: pkgConfig.name,\n    bundleId: pkgConfig.id,\n    bundleVersion: pkgConfig.version,\n    cepVersion: pkgConfig.cepVersion,\n    hosts: pkgConfig.hosts,\n    iconNormal: pkgConfig.iconNormal,\n    iconRollover: pkgConfig.iconRollover,\n    iconDarkNormal: pkgConfig.iconDarkNormal,\n    iconDarkRollover: pkgConfig.iconDarkRollover,\n    panelWidth: pkgConfig.panelWidth,\n    panelHeight: pkgConfig.panelHeight,\n    panelMinWidth: pkgConfig.panelMinWidth,\n    panelMinHeight: pkgConfig.panelMinHeight,\n    panelMaxWidth: pkgConfig.panelMaxWidth,\n    panelMaxHeight: pkgConfig.panelMaxHeight,\n    debugPorts: pkgConfig.debugPorts,\n    debugInProduction: pkgConfig.debugInProduction,\n    lifecycle: pkgConfig.lifecycle,\n    cefParams: pkgConfig.cefParams,\n    htmlFilename: pkgConfig.htmlFilename,\n    extensions: pkgConfig.extensions\n  }\n}\n\nfunction getConfigDefaults() {\n  return {\n    ...getExtensionDefaults(),\n    bundleName: 'CEP Extension',\n    bundleId: 'com.mycompany.myextension',\n    hosts: '*',\n    debugInProduction: false,\n    cepVersion: '7.0'\n  }\n}\n\nexport function getConfig(pkg, env) {\n  const config = defaults(\n    getEnvConfig(),\n    getPkgConfig(pkg, env),\n    getConfigDefaults(),\n    {\n      bundleVersion: pkg.version\n    }\n  )\n  config.hosts = parseHosts(config.hosts)\n  let extensions = []\n  if (Array.isArray(config.extensions)) {\n    extensions = config.extensions.map(extension => {\n      return {\n        ...getExtensionDefaults(),\n        ...extension\n      }\n    })\n  } else {\n    extensions.push({\n      id: config.bundleId,\n      name: config.bundleName,\n      ...config\n    })\n  }\n  config.extensions = extensions\n  return config\n}\n\nexport function objectToProcessEnv(obj) {\n  // assign object to process.env so they can be used in the code\n  Object.keys(obj).forEach(key => {\n    const envKey = camelToSnake(key).toUpperCase()\n    const value = typeof obj[key] === 'string'\n      ? obj[key]\n      : JSON.stringify(obj[key])\n    process.env[envKey] = value\n  })\n}\n\nexport function writeExtensionTemplates(opts) {\n  const manifestContents = manifestTemplate(opts)\n  const {\n    out,\n    debugInProduction,\n    isDev,\n    extensions\n  } = opts\n  const manifestDir = path.join(out, 'CSXS')\n  const manifestFile = path.join(manifestDir, 'manifest.xml')\n  return Promise.resolve()\n    .then(() => fs.ensureDir(manifestDir))\n    .then(() => fs.writeFile(manifestFile, manifestContents))\n    .then(() => {\n      let chain = Promise.resolve()\n      if (debugInProduction || isDev) {\n        const debugContents = debugTemplate(opts)\n        chain = chain.then(() => fs.writeFile(path.join(out, '.debug'), debugContents))\n      }\n      if (isDev) {\n        extensions.forEach(extension => {\n          const href = `http://${extension.devHost}:${extension.devPort}`\n          const panelContents = panelTemplate({\n            title: extension.name,\n            href\n          })\n          chain = chain.then(() => fs.writeFile(path.join(out, `dev.${extension.id}.html`), panelContents))\n        })\n      }\n      return chain\n    })\n}\n\nexport function parseHosts(hostsString) {\n  if (hostsString == '*')\n    hostsString = `PHXS, IDSN, AICY, ILST, PPRO, PRLD, AEFT, FLPR, AUDT, DRWV, MUST, KBRG`\n  const hosts = hostsString\n    .split(/(?![^)(]*\\([^)(]*?\\)\\)),(?![^\\[]*\\])/)\n    .map(host => host.trim())\n    .map(host => {\n      let [name, version] = host.split('@')\n      if (version == '*' || !version) {\n        version = '[0.0,99.9]'\n      } else if (version) {\n        version = version\n      }\n      return {\n        name,\n        version,\n      }\n    })\n  return hosts\n}\n\nexport function getExtenstionPath() {\n  if (process.platform == 'darwin') {\n    return path.join(\n      os.homedir(),\n      '/Library/Application Support/Adobe/CEP/extensions'\n    )\n  } else if (process.platform == 'win32') {\n    return path.join(process.env.APPDATA, 'Adobe/CEP/extensions')\n  }\n}\n\nfunction getSymlinkExtensionPath({ bundleId }) {\n  const extensionPath = getExtenstionPath()\n  return path.join(extensionPath, bundleId)\n}\n\nexport function symlinkExtension({ bundleId, out }) {\n  const target = getSymlinkExtensionPath({ bundleId })\n  return Promise.resolve()\n    .then(() => fs.ensureDir(getExtenstionPath()))\n    .then(() => fs.remove(target))\n    .then(() => {\n      if (process.platform === 'win32') {\n        return fs.symlink(path.join(out, '/'), target, 'junction')\n      } else {\n        return fs.symlink(path.join(out, '/'), target)\n      }\n    })\n}\n\nexport function copyDependencies({ root, out, pkg }) {\n  const deps = pkg.dependencies || {}\n  return Object.keys(deps).reduce((chain, dep) => {\n    const src = path.join(root, 'node_modules', dep)\n    const dest = path.join(out, 'node_modules', dep)\n    let exists = false\n    try {\n      exists = fs.statSync(dest).isFile();\n    } catch (err) {}\n    if (!exists) {\n      chain = chain\n        .then(() => fs.copy(src, dest))\n        .catch(() => {\n          console.error(\n            `Could not copy ${src} to ${dest}. Ensure the path is correct.`\n          )\n        })\n        .then(() => {\n          try {\n            const packageJson = fs.readJsonSync(path.join(root, 'node_modules', dep, 'package.json'))\n            return copyDependencies({\n              root,\n              out,\n              pkg: packageJson\n            })\n          } catch (err) {\n            return\n          }\n        })\n      return chain\n    }\n    return chain\n  }, Promise.resolve())\n}\n\nexport function copyIcons({\n  root,\n  out,\n  iconNormal,\n  iconRollover,\n  iconDarkNormal,\n  iconDarkRollover\n}) {\n  const iconPaths = [\n    iconNormal,\n    iconRollover,\n    iconDarkNormal,\n    iconDarkRollover,\n  ]\n    .filter(icon => icon !== undefined)\n    .map(icon => ({\n        source: path.resolve(root, icon),\n        output: path.join(out, path.relative(root, icon)),\n    }))\n  return Promise.all(\n    iconPaths.map(icon => {\n      return fs.copy(icon.source, icon.output)\n        .catch(() => {\n          console.error(\n            `Could not copy ${icon.source}. Ensure the path is correct.`\n          )\n        })\n    })\n  )\n}\n\nfunction getExtensionDefaults() {\n  return {\n    panelWidth: 500,\n    panelHeight: 500,\n    htmlFilename: './index.html',\n    devPort: 8080,\n    devHost: 'localhost',\n    lifecycle: {\n      autoVisible: true,\n      startOnEvents: []\n    },\n    cefParams: [\n      '--allow-file-access-from-files',\n      '--allow-file-access',\n      '--enable-nodejs',\n      '--mixed-context'\n    ],\n    debugPorts: {\n      PHXS: 3001,\n      IDSN: 3002,\n      AICY: 3003,\n      ILST: 3004,\n      PPRO: 3005,\n      PRLD: 3006,\n      AEFT: 3007,\n      FLPR: 3008,\n      AUDT: 3009,\n      DRWV: 3010,\n      MUST: 3011,\n      KBRG: 3012,\n    }\n  }\n}\n\nexport function compile(opts) {\n  opts.env = opts.env ? opts.env : process.env.NODE_ENV\n  opts.root = opts.root ? opts.root : process.cwd()\n  opts.htmlFilename = opts.htmlFilename ? opts.htmlFilename : './index.html'\n  opts.pkg = opts.pkg ? opts.pkg : require(path.join(opts.root, '/package.json'))\n  opts.devHost = opts.devHost ? opts.devHost : 'localhost'\n  opts.devPort = opts.devPort ? opts.devPort : 8080\n  opts.isDev = opts.hasOwnProperty('isDev') ? opts.isDev : false\n  const config = getConfig(opts.pkg, opts.env)\n  const allOpts = {\n    ...opts,\n    ...config,\n  }\n  let chain = Promise.resolve()\n  if (opts.isDev) {\n    enablePlayerDebugMode()\n    if (!config.noSymlink) {\n      chain = chain.then(() => symlinkExtension(allOpts))\n    }\n  }\n  chain = chain.then(() => copyDependencies(allOpts))\n    .then(() => writeExtensionTemplates(allOpts))\n    .then(() => copyIcons(allOpts))\n  return chain\n}"],"names":["sizeTemplate","name","width","height","undefined","isDev","bundleName","bundleId","hosts","bundleVersion","cepVersion","extensions","map","extension","id","join","host","version","commandLineParams","cefParams","cefParam","icons","icon","iconNormal","type","iconRollover","iconDarkNormal","iconDarkRollover","filter","size","panelWidth","panelHeight","minSize","panelMinWidth","panelMinHeight","maxSize","panelMaxWidth","panelMaxHeight","startOn","lifecycle","startOnEvents","length","e","htmlFilename","autoVisible","menu","title","href","Object","keys","debugPorts","trim","templateDebug","formatter","os","EOL","enablePlayerDebugMode","process","platform","execSync","i","disablePlayerDebugMode","camelToSnake","str","replace","part","toLowerCase","isTruthy","getEnvConfig","debugPortEnvs","env","key","indexOf","CEP_NAME","CEP_ID","CEP_VERSION","CEP_CEP_VERSION","CEP_HOSTS","CEP_ICON_NORMAL","CEP_ICON_ROLLOVER","CEP_ICON_DARK_NORMAL","CEP_ICON_DARK_ROLLOVER","CEP_PANEL_WIDTH","CEP_PANEL_HEIGHT","CEP_PANEL_MIN_WIDTH","CEP_PANEL_MIN_HEIGHT","CEP_PANEL_MAX_WIDTH","CEP_PANEL_MAX_HEIGHT","reduce","obj","parseInt","debugInProduction","CEP_DEBUG_IN_PRODUCTION","CEP_CEF_PARAMS","split","getPkgConfig","pkg","pkgConfig","hasOwnProperty","cep","getConfigDefaults","getExtensionDefaults","getConfig","config","defaults","parseHosts","Array","isArray","push","objectToProcessEnv","forEach","envKey","toUpperCase","value","JSON","stringify","writeExtensionTemplates","opts","manifestContents","manifestTemplate","out","manifestDir","path","manifestFile","Promise","resolve","then","fs","ensureDir","writeFile","chain","debugContents","debugTemplate","devHost","devPort","panelContents","panelTemplate","hostsString","getExtenstionPath","homedir","APPDATA","getSymlinkExtensionPath","extensionPath","symlinkExtension","target","remove","symlink","copyDependencies","root","deps","dependencies","dep","src","dest","exists","statSync","isFile","err","copy","console","error","packageJson","readJsonSync","copyIcons","iconPaths","source","output","relative","all","PHXS","IDSN","AICY","ILST","PPRO","PRLD","AEFT","FLPR","AUDT","DRWV","MUST","KBRG","compile","NODE_ENV","cwd","require","allOpts","noSymlink"],"mappings":"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"}